{
    "attack-pattern": {
        "type": "object",
        "import": "common-properties",
        "required": ["external_references", "kill_chain_phases", "created_by_ref"],
        "properties":{
            "type": "attack-pattern",
            "created_by_ref": {
                "type": "string",
                "semantics": "stix-id",
                "stix-type": "identity"
            },
            "external_references":{
                "type": "array",
                "ref": "external-references"
            }
        }
    },
    "campaign": {
        "type": "object",
        "import": "common-properties",
        "required": ["created_by_ref"],
        "properties":{
            "type": "campaign",
            "created_by_ref": {
                "type": "string",
                "semantics": "stix-id",
                "stix-type": "identity"
            }
        }
    },
    "course-of-action": {
        "type": "object",
        "import": "common-properties",
        "required": ["created_by_ref"],
        "properties":{
            "type": "course-of-action",
            "created_by_ref": {
                "type": "string",
                "semantics": "stix-id",
                "stix-type": "identity"
            }
        }
    },
    "grouping": {
        "type": "object",
        "import": "common-properties",
        "required": ["identities_class", "created_by_ref"],
        "properties":{
            "type": "grouping",
            "created_by_ref": {
                "type": "string",
                "semantics": "stix-id",
                "stix-type": "identity"
            }
        }
    },
    "incident": {
        "type": "object",
        "import": "common-properties",
        "required": ["created_by_ref"],
        "properties":{
            "type": "incident",
            "created_by_ref": {
                "type": "string",
                "semantics": "stix-id",
                "stix-type": "identity"
            }
        }
    },
    "identity": {
        "type": "object",
        "import": "common-properties",
        "required": ["identity_class", "created_by_ref"],
        "properties":{
            "type": "identity",
            "created_by_ref": {
                "type": "string",
                "semantics": "stix-id",
                "stix-type": "identity"
            }
        }
    },
    "indicator": {
        "type": "object",
        "import": "common-properties",
        "required": ["indicator_types","name", "created_by_ref"],
        "properties":{
            "type": "indicator",
            "created_by_ref": {
                "type": "string",
                "semantics": "stix-id",
                "stix-type": "identity"
            }
        }
    },
    "infrastructure": {
        "type": "object",
        "import": "common-properties",
        "required": ["infrastructure_types", "created_by_ref"],
        "properties":{
            "type": "infrastructure",
            "created_by_ref": {
                "type": "string",
                "semantics": "stix-id",
                "stix-type": "identity"
            }
        }
    },
    "intrusion-set": {
        "type": "object",
        "import": "common-properties",
        "required": ["resource_level", "primary_motivations", "created_by_ref"],
        "properties":{
            "type": "intrusion set",
            "created_by_ref": {
                "type": "string",
                "semantics": "stix-id",
                "stix-type": "identity"
            }
        }
    },
    "location": {
        "type": "object",
        "import": "common-properties",
        "required": ["region", "created_by_ref"],
        "properties":{
            "type": "location",
            "created_by_ref": {
                "type": "string",
                "semantics": "stix-id",
                "stix-type": "identity"
            }
        }
    },
    "malware": {
        "type": "object",
        "import": "common-properties",
        "required": ["malware_types", "is_family", "first_seen", "last_seen", "architecture_execution_envs", "implementation_languages", "capabilities", "name", "created_by_ref"],
        "properties":{
            "type": "malware",
            "created_by_ref": {
                "type": "string",
                "semantics": "stix-id",
                "stix-type": "identity"
            }
        }
    },
    "malware-analysis": {
        "type": "object",
        "import": "common-properties",
        "required": ["version", "submitted", "analysis_started", "analysis_ended", "result", "created_by_ref"],
        "properties":{
            "type": "malware-analysis",
            "created_by_ref": {
                "type": "string",
                "semantics": "stix-id",
                "stix-type": "identity"
            }
        }
    },
    "note": {
        "type": "object",
        "import": "common-properties",
        "required": ["created_by_ref"],
        "properties":{
            "type": "note",
            "created_by_ref": {
                "type": "string",
                "semantics": "stix-id",
                "stix-type": "identity"
            }
        }
    },
    "observed-data": {
        "type": "object",
        "import": "common-properties",
        "required": ["object_refs", "created_by_ref"],
        "properties":{
            "type": "observed-data",
            "created_by_ref": {
                "type": "string",
                "semantics": "stix-id",
                "stix-type": "identity"
            }
        }
    },
    "opinion": {
        "type": "object",
        "import": "common-properties",
        "required": ["created_by_ref"],
        "properties":{
            "type": "opinion",
            "created": {
                "type": "string",
                "semantics":"stix-timestamp"
            },
            "modified": {
                "type": "string",
                "semantics": "stix-timestamp"
            },
            "spec_version":"2.1",
            "created_by_ref": {
                "type": "string",
                "semantics": "stix-id",
                "stix-type": "identity"
            },
            "name": {
                "type": "string",
                "semantics": "word"
            }
        }
    },
    "report": {
        "type": "object",
        "import": "common-properties",
        "required": ["report_types", "created_by_ref"],
        "properties":{
            "type": "report",
            "created_by_ref": {
                "type": "string",
                "semantics": "stix-id",
                "stix-type": "identity"
            }
        }
    },
    "threat-actor": {
        "type": "object",
        "import": "common-properties",
        "required": ["threat_actor_types", "roles", "sophistication", "resource_level", "primary_motivation", "created_by_ref"],
        "properties":{
            "type": "threat-actor",
            "created_by_ref": {
                "type": "string",
                "semantics": "stix-id",
                "stix-type": "identity"
            }
        }
    },
    "tool": {
        "type": "object",
        "import": "common-properties",
        "required": ["tool_types", "created_by_ref"],
        "properties":{
            "type": "tool",
            "created_by_ref": {
                "type": "string",
                "semantics": "stix-id",
                "stix-type": "identity"
            }
        }
    },
    "vulnerability": {
        "type": "object",
        "import": "common-properties",
        "required": ["created_by_ref", "external_references"],
        "properties":{
            "created_by_ref": {
                "type": "string",
                "semantics": "stix-id",
                "stix-type": "identity"
            },
            "external_references": {
                "type": "array",
                "ref": "external-references"
            }
        }

    },
    "sighting": {
        "type": "object",
        "import": "common-properties",
        "required": ["first_seen", "last_seen", "count", "created_by_ref"],
        "properties":{
            "first_seen": {
                "type": "string",
                "semantics": "stix-timestamp"
            },
            "last_seen": {
                "type": "string",
                "semantics": "stix-timestamp"
            },
            "count": {
                "type": "integer",
                "minimum": 0,
                "maximum": 999999999
            },
            "created_by_ref": {
                "type": "string",
                "semantics": "stix-id",
                "stix-type": "identity"
            }
        }
    },
    "common-properties": {
        "properties":{
            "object_marking_refs": {
                "type": "array",
                "items": {
                    "type": "string",
                    "semantics": "stix-id",
                    "stix-type": "marking-definition"
                },
                "maxItems": 1,
                "minItems": 1
            }
        }
    }
}
